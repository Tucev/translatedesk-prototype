<div id="translator-request-queue" class="span4" ng-controller="TwitterController">
  <div class="well">
    <h5>Translator Request Queue</h5>
    <form ng-submit="fetch()">
      <div class="searchbox controls controls-row input-append">
        <input type="text" class="span9" ng-model="tweetQuery" placeholder="Keywork, #hashtag or @username">
        <button class="btn">Search</button>
      </div>

      <label>Sort by</label>
      <select ng-model="sortCriteria" class="span12">
        <option value="popularity">Popularity</option>
        <option value="created_at">Date and Time</option>
        <option value="distance">Location</option>
      </select>

      <label>Sort order</label>
      <select ng-model="sortOrder" class="span12">
        <option value="">Ascending</option>
        <option value="reverse">Descending</option>
      </select>

      <label>Limit</label>
      <select ng-model="searchLimit" ng-change="tweets.length && fetch()" class="span12">
        <option value="10">10</option>
        <option value="20">20</option>
        <option value="50">50</option>
        <option value="100">100</option>
      </select>

      <label>Filters</label>
      <ul class="filters">
        <li><input type="checkbox" ng-model="filter.in_reply_to_status_id" /> contains @reply</li>
        <li><input type="checkbox" ng-model="filter.is_not_reply" /> no @reply</li>
        <li><input type="checkbox" ng-model="filter.retweeted_status" /> contains "RT"</li>
        <li><input type="checkbox" ng-model="filter.media_count" /> contains image</li>
        <li><input type="checkbox" ng-model="filter.urls_count" /> contains link</li>
        <li><input type="checkbox" ng-model="filter.distance" /> contains location</li>
      </ul>
    </form>
    <div class="message" ng-show="message">{{message}}</div>
    <h5 class="results-count" ng-show="(tweets | filter:filterQueue).length">There are {{(tweets | filter:filterQueue).length}} tweets.</h5>
    <ul class="tweets">
      <li class="tweet" ng-repeat="tweet in tweets | orderBy:sortQueue:sortOrder | filter:filterQueue" ng-include="'/assets/tweet.html'"></li>
    </ul>
  </div>
</div>
 
<div id="translation-workbench" class="span5" ng-controller="TranslationController">
  <h5>Translation Workbench</h5>
  
  <!-- FIXME: Is there a way to bind variables instead of using ng-repeat? -->
  <div class="translation-workbench-inner" ng-show="workbench.source" ng-repeat="tweet in [workbench.source]">

    <div id="translation-source" class="well">
      <div ng-include="'/assets/tweet.html'"></div>
    </div>

    <div id="translation-target" class="well">
      <form ng-submit="publish()">

        <textarea ng-model="translatedTweet" ng-init="prepareTranslation(tweet)" ng-change="updateModel(translatedTweet)" class="span12"></textarea>

        <div id="preview" class="modal hide fade in" style="display: none;">
          <div class="modal-header">
            <a class="close" data-dismiss="modal">X</a>
            <h3>Preview</h3>
          </div>
          <div class="modal-body">
            <p>{{previewContent}}</p>
          </div>
          <div class="modal-footer">
            <a href="#" class="btn" data-dismiss="modal">Close</a>
            <input type="submit" value="Publish" class="btn btn-primary" id="publish-tweet-button" /> <span ng-bind-html-unsafe="publishingMessage"></span>
          </div>
        </div>

        <p class="publish">
          <a class="btn btn-info" ng-click="preview()">Preview & Publish</a> 
        </p>
      </form>
      <p class="counter" ng-class="{ 'tweet-limit-exausted' : translatedTweet.length > 140 }">{{140 - translatedTweet.length}}</p>
      <p class="autosave" ng-show="lastSave.ago">Draft saved {{lastSave.ago}}</p>

      <div class="btn-group open mt">
        <a class="btn btn-mini" href="#">Machine translation</a>
        <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#">
          <span class="icon-caret-down"></span>
        </a>
        <div class="dropdown-menu" ng-click="$event.stopPropagation()">
          <div class="dropdown-menu-inner">
            <form ng-submit="machineTranslate()">
              <p class="mt-message">{{machineTranslationMessage}}</p>
              <ul>
                <li>
                  <label>Provider</label> 
                  <span>
                    <select ng-change="selectMachineTranslator()" ng-init="getMachineTranslators()" ng-model="machineTranslator" ng-options="provider.name for provider in machineTranslators" required>
                      <option value="">Choose</option>
                    </select>
                  </span>
                </li>
                <li>
                  <label>From</label> 
                  <span>
                    <select ng-model="sourceLanguage" ng-options="language.code as language.name for language in machineTranslator.languages" required>
                      <option value="">Choose</option>
                    </select>
                  </span>
                </li>
                <li>
                  <label>To</label> 
                  <span>
                    <select ng-model="targetLanguage" ng-options="language.code as language.name for language in machineTranslator.languages" required>
                      <option value="">Choose</option>
                    </select>
                  </span>
                </li>
              </ul>
              <p><input type="submit" class="btn btn-mini" value="Translate" /></p>
            </form>
          </div>
        </div>
      </div>

      <div class="workbench-form-footer"></div>
    </div>

    <div id="translations">
      <h5>Translations</h5>
      <ul class="tweets">
        <li class="tweet well well-small" ng-repeat="tweet in translations">
          <p class="translation-info">Translated to {{tweet.target_language_readable}} by <a href="{{tweet.author_url}}" target="_blank">{{tweet.author_name}}</a> on {{tweet.created_at | date:'h:mma Z d MMM yy'}}</p>
          <p class="translation-text">{{tweet.text}} <span><i class="icon-external-link"></i> <a href="{{tweet.twitter_url}}" target="_blank">See on Twitter</a></span></p>
        </li>
      </ul>
    </div>

  </div>
</div>

<div id="dictionary" class="span3">
  <div class="well">
    <h5>Dictionary</h5>
  </div>
</div>
